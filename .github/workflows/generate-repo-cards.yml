name: Generate Repo Cards

on:
  workflow_dispatch:
  schedule:
    - cron: '0 */8 * * *'   # каждые 8 часов

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create cards folder
        run: mkdir -p .github/profile/cards

      - name: Download and save repo cards (pure curl, no npm bullshit)
        run: |
          repos=(
            "Auto-Role-Channel-Bot-Discord"
            "UE-Widget-Development"
            # Добавляй сюда сколько угодно репозиториев
          )

          for repo in "${repos[@]}"; do
            echo "Скачиваем карточку для $repo"
            curl -sL \
              "https://github-readme-stats.vercel.app/api/pin/?username=AnikBeris&repo=$repo&theme=tokyonight&hide_border=true&border_radius=12&bg_color=1f1f28&title_color=7aa2f7&text_color=cdd6f4&icon_color=bb9af7" \
              -o ".github/profile/cards/$repo.svg"
          done

      - name: Commit and push if changed
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add .github/profile/cards/*.svg
          git diff --quiet && git diff --staged --quiet || (
            git commit -m "Update repo cards [auto]" 
            git push
          )
